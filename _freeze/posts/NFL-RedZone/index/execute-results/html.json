{
  "hash": "b0fcaca443194ecde8c186be0234f448",
  "result": {
    "markdown": "---\ntitle: \"NFL Redzone EPA\"\nauthor: \"Alexa Henry\"\ndate: '2023-11-2'\ncategories: [football, NFL]\nimage: \"image.png\"\nformat: \n  html:\n    code-fold: true\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.3     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.4     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.0\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(nflreadr)\nlibrary(ggalt)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRegistered S3 methods overwritten by 'ggalt':\n  method                  from   \n  grid.draw.absoluteGrob  ggplot2\n  grobHeight.absoluteGrob ggplot2\n  grobWidth.absoluteGrob  ggplot2\n  grobX.absoluteGrob      ggplot2\n  grobY.absoluteGrob      ggplot2\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplays <- load_pbp(2022)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(plays)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── nflverse play by play data ──────────────────────────────────────────────────\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nℹ Data updated: 2023-02-28 04:24:38 EST\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 372\n  play_id game_id      old_game_id home_team away_team season_type  week posteam\n    <dbl> <chr>        <chr>       <chr>     <chr>     <chr>       <int> <chr>  \n1       1 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 <NA>   \n2      43 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 NYJ    \n3      68 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 NYJ    \n4      89 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 NYJ    \n5     115 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 NYJ    \n6     136 2022_01_BAL… 2022091107  NYJ       BAL       REG             1 NYJ    \n# ℹ 364 more variables: posteam_type <chr>, defteam <chr>, side_of_field <chr>,\n#   yardline_100 <dbl>, game_date <chr>, quarter_seconds_remaining <dbl>,\n#   half_seconds_remaining <dbl>, game_seconds_remaining <dbl>,\n#   game_half <chr>, quarter_end <dbl>, drive <dbl>, sp <dbl>, qtr <dbl>,\n#   down <dbl>, goal_to_go <dbl>, time <chr>, yrdln <chr>, ydstogo <dbl>,\n#   ydsnet <dbl>, desc <chr>, play_type <chr>, yards_gained <dbl>,\n#   shotgun <dbl>, no_huddle <dbl>, qb_dropback <dbl>, qb_kneel <dbl>, …\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntype_plays <- c(\"pass\", \"run\")\n\nplays |>\n  filter(play_type %in% type_plays) |>\n  filter(posteam == \"MIA\") |>\n  filter(week < 4) |>\n  filter (yardline_100 < 20) |>\n  summarise(\n    Totalplays = n()\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  Totalplays\n       <int>\n1         20\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplays |>\n  filter(play_type %in% type_plays) |>\n  filter(posteam == \"MIA\") |>\n  filter(week < 4) |>\n  filter (yardline_100 < 20) |>\n  summarise(\n    TotalEPA = sum(epa)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  TotalEPA\n     <dbl>\n1     9.00\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplays |>\n  filter(play_type %in% type_plays) |>\n  filter(posteam == \"MIA\") |>\n  filter (yardline_100 < 20) |>\n  summarise(\n    TotalEPA = sum(epa)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  TotalEPA\n     <dbl>\n1     6.10\n```\n:::\n:::\n\nIn the first three weeks of the 2022 season, Miami had 9 EPA but dropped down by almost 3 points by the end of the season. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n9.000518\t- 6.102557\t\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 2.897961\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnfl_plays_week3 <- plays |>\n  group_by(posteam) |>\n  filter(play_type %in% type_plays) |>\n  filter(week < 4) |>\n  filter (yardline_100 < 20)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnfl_plays_week3 <- nfl_plays_week3|>\n  group_by(posteam) |>\n  filter(play_type %in% type_plays) |>\n  filter(week < 4) |>\n  filter (yardline_100 < 20) |>\n  summarise(\n    TotalEPA_3 = sum(epa),\n    Totalplays_3 = n())\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnfl_plays_week8 <- plays |>\n  group_by(posteam) |>\n  filter(play_type %in% type_plays) |>\n  filter(week < 9) |>\n  filter (yardline_100 < 20)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnfl_plays_week8 <- nfl_plays_week8 |>\n  group_by(posteam) |>\n  filter(play_type %in% type_plays) |>\n  filter(week < 9) |>\n  filter (yardline_100 < 20) |>\n  summarise(\n    Totalplays_8 = n(),\n    TotalEPA_8 = sum(epa))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntotal_nfl <- nfl_plays_week3 |> left_join(nfl_plays_week8, join_by(posteam)) \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() + \n  geom_dumbbell(\n    data=total_nfl, \n    aes(y=posteam, x=TotalEPA_3, xend=TotalEPA_8)\n  )\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Using the `size` aesthetic with geom_segment was deprecated in ggplot2 3.4.0.\nℹ Please use the `linewidth` aesthetic instead.\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot() + \n  geom_dumbbell(\n    data=total_nfl, \n    aes(y=reorder(posteam,TotalEPA_3), x=TotalEPA_3, xend=TotalEPA_8),\n    size = 1,\n    colour = \"grey\",\n    colour_x = \"green\",\n    colour_xend = \"blue\") +\n  theme_minimal() +\n  labs(title = \"Most NFL teams experienced higher EPA's through week 8 in 2022\", y=\"team\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\nIt appears some teams actually experienced a higher EPA as they continued through the 2022 season. However the outlier in this is Jacksonville. Jacksonville experienced a drop in their EPA as they went through the season. They did barely make the playoffs that year and I believe lost so this can be a reflection of their regression in the season. One team that started with a high EPA and ended with a high EPA was Kansas City and they obviously went on to win the superbowl because the Eagles defense didn't show up in the second half of the game. Regardless, besides certain teams, it does seem to be that if you start with an average EPA, teams typically finish high. \n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}